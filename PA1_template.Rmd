# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

``` {r setoptions, echo=TRUE}
library(plyr)
options(scipen=999)
zipPath <- "activity.zip";
filename <- "activity.csv";
csvfile <- unz (zipPath, filename);
raw_data <- read.csv(csvfile)
clean_data <- raw_data[!is.na(raw_data$steps), ]
clean_data <- clean_data[clean_data$steps != 0, ]

# group data by date and sum the steps
aggregate_data <- aggregate(x=clean_data$steps, by=list(clean_data$date), FUN = sum)
colnames(aggregate_data) <- c('date', 'total_steps')

# group by number of steps and count number of occurrences
aggregate_steps <- count(aggregate_data, "total_steps")
colnames(aggregate_steps) <- c('steps', 'frequency')
aggregate_data <- aggregate_data[order(aggregate_data$total_steps), ]

mean_steps = mean(aggregate_data$total_steps)
median_steps = median(aggregate_data$total_steps)

# aggregate steps by intervals
num_dates = nrow(aggregate_data)
aggregate_interval <- aggregate(x=clean_data$steps, by=list(clean_data$interval), FUN = sum)
colnames(aggregate_interval) <- c('interval', 'total_steps')
aggregate_interval$avg_steps <- aggregate_interval$total_steps / num_dates
max_interval <- aggregate_interval[aggregate_interval$avg_steps == max(aggregate_interval$avg_steps), c('interval')]

num_missing_data_row <- nrow(raw_data[is.na(raw_data$steps), ])

```

## What is mean total number of steps taken per day?

``` {r total_steps, fig.width=10 }
library(ggplot2)
p1 <- ggplot(aggregate_data, aes(x=aggregate_data$total_steps))
p1 <- p1 + geom_histogram(fill="red", color="black", binwidth=1000) + ggtitle("Frequency of total steps taken per day") + xlab('Total number of steps per day') + ylab('Frequency')
print (p1)
```

1. The mean total number of steps taken per day is `r mean_steps`.
2. The median total number of steps taken per day is `r median_steps`.

## What is the average daily activity pattern?

``` {r timeseriesplot, fig.width=10 }
p2 <- ggplot(aggregate_interval, aes(y=aggregate_interval$total_steps, x=aggregate_interval$interval))
p2 <- p2 + geom_line(color="red") + geom_point()
p2 <- p2 + xlab('Time interval') + ylab('Total steps') + ggtitle('Average daily activity pattern')
print (p2)
```

1. The 5-minute interval that contains the maximum average number of steps taken is `r max_interval`.

## Inputing missing values

1. Number of rows with NA data equals `r num_missing_data_row`.

## Are there differences in activity patterns between weekdays and weekends?
